---
import "@fontsource/jetbrains-mono/400.css";
import "@fontsource/jetbrains-mono/500.css";
import "@fontsource/jetbrains-mono/700.css";
import "@fontsource/press-start-2p/400.css";
import "../styles/global.css";
import { SEO } from "astro-seo";
import { ViewTransitions } from "astro:transitions";
import OgImage from "../../public/og_image.jpg";
import Header from "../components/layout/Header.astro";
import Footer from "../components/layout/Footer.astro";

interface Props {
  title?: string;
  description?: string;
  ogImage?: string;
}

const defaultTitle = "Christian Anunciado | Full-Stack & AI Engineer";
const defaultDescription = "Full-stack & AI engineer building modern, scalable web applications and intelligent solutions.";

const { title = defaultTitle, description = defaultDescription, ogImage } = Astro.props;
const canonicalURL = new URL(Astro.url.pathname, Astro.site);
const ogImageURL = ogImage || OgImage.src;
const MEASUREMENT_ID = import.meta.env.GA_MEASUREMENT_ID;
---

<!doctype html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="generator" content={Astro.generator} />
    <SEO
      title={title}
      description={description}
      canonical={canonicalURL.href}
      openGraph={{
        basic: {
          title: title,
          image: ogImageURL,
          type: "website",
          url: canonicalURL.href,
        },
        optional: {
          description: description,
        },
      }}
      twitter={{
        card: "summary_large_image",
        title: title,
        description: description,
        image: ogImageURL,
      }}
    />

    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "WebSite",
          "name": "Christian Anunciado",
          "url": "https://www.christiananunciado.com",
        },
        {
          "@type": "Person",
          "name": "Christian Anunciado",
          "url": "https://www.christiananunciado.com",
          "jobTitle": "Full-Stack & AI Engineer",
          "sameAs": [
            "https://github.com/christian-anunciado",
            "https://www.linkedin.com/in/christiananunciado/"
          ],
        }
      ]
    })} />

    <!-- Google tag (gtag.js) -->
    <script
      is:inline
      type="text/partytown"
      async
      src={`https://www.googletagmanager.com/gtag/js?id=${MEASUREMENT_ID}`}
    ></script>
    <script type="text/partytown" is:inline>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", MEASUREMENT_ID);
    </script>

    <ViewTransitions />

    <script is:inline>
      function setDarkMode(document) {
        const parent = document.documentElement;
        if (localStorage.theme === undefined) {
          localStorage.setItem("theme", "dark");
        }

        if (localStorage.theme === "dark") {
          parent.classList.add("dark");
        }

        if (localStorage.theme === "light") {
          parent.classList.remove("dark");
        }
      }

      setDarkMode(document);

      document.addEventListener("astro:before-swap", (ev) => {
        setDarkMode(ev.newDocument);
      });
    </script>

    <style is:global>
      ::-webkit-scrollbar {
        width: 8px;
      }

      ::-webkit-scrollbar-track {
        background: transparent;
      }

      ::-webkit-scrollbar-thumb {
        background: rgba(156, 163, 175, 0.5);
      }

      ::-webkit-scrollbar-thumb:hover {
        background: rgba(156, 163, 175, 0.7);
      }

      .dark ::-webkit-scrollbar-thumb {
        background: rgba(75, 85, 99, 0.5);
      }

      .dark ::-webkit-scrollbar-thumb:hover {
        background: rgba(75, 85, 99, 0.7);
      }
    </style>
  </head>

  <body class="scanline min-h-screen bg-bg text-text-primary font-mono antialiased">
    <Header />

    <main class="relative z-10">
      <slot />
    </main>

    <Footer />
  </body>
</html>
